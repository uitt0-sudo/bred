import React,{useEffect,useState}from'react'
import Card from'../components/Card.jsx'
import Modal from'../ui/Modal.jsx'
import {useApp}from'../store'
export default function Books(){const [items,setItems]=useState([]);const [open,setOpen]=useState(null);const [i,setI]=useState(0);const {gainStar,play}=useApp();useEffect(()=>{fetch('/public/data/content.json').then(r=>r.json()).then(d=>setItems(d['books']))},[]);const story=open&&open.story;return(<div><h2>Books</h2><div className='grid'>{items.map(it=><Card key={it.id||it.title} item={it} onOpen={()=>{setOpen(it);setI(0)}} cta={it.story?'Read':'Open'}/>)}</div><Modal open={!!open} title={open?.title} onClose={()=>setOpen(null)}>{story?(<div><p className='muted'>{story[i].text}</p><div className='row'><button className='btn ghost' onClick={()=>setI(v=>Math.max(0,v-1))}>Prev</button><button className='btn' onClick={()=>setI(v=>Math.min(story.length-1,v+1))}>Next</button></div><div className='small muted' style={{marginTop:8}}>Page {i+1}/{story.length}</div>{i===story.length-1&&<div style={{marginTop:10}}><button className='btn' onClick={()=>{gainStar();play('success');alert('⭐ Read‑along complete!')}}>Finish</button></div>}</div>):(<p className='muted'>Sample book content.</p>)}</Modal></div>)}
