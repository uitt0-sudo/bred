import React,{useEffect,useState}from'react'
import Card from'../components/Card.jsx'
import Modal from'../ui/Modal.jsx'
import {useApp}from'../store'
export default function Quiz(){const [items,setItems]=useState([]);const [open,setOpen]=useState(null);const [i,setI]=useState(0);const [score,setScore]=useState(0);const {gainStar,play}=useApp();useEffect(()=>{fetch('/public/data/content.json').then(r=>r.json()).then(d=>setItems(d['quizzes']))},[]);const q=open&&open.questions[i];function pick(idx){if(idx===q.c)setScore(s=>s+1);if(i<open.questions.length-1)setI(i+1);else alert(`Your score: ${score+(idx===q.c?1:0)} / ${open.questions.length}`)}return(<div><h2>Quiz</h2><div className='grid'>{items.map(it=><Card key={it.id} item={it} onOpen={()=>{setOpen(it);setI(0);setScore(0)}} cta='Take Quiz'/>)}</div><Modal open={!!open} title={open?.title} onClose={()=>setOpen(null)}>{q?(<div><div className='panel'><b>{q.q}</b><div className='grid' style={{gridTemplateColumns:'repeat(2,1fr)',marginTop:10}}>{q.a.map((a,idx)=>(<button key={idx} className='btn' onClick={()=>pick(idx)}>{a}</button>))}</div><div className='small muted' style={{marginTop:8}}>Q {i+1}/{open.questions.length}</div></div></div>):(<div><p className='muted'>Quiz complete!</p><button className='btn' onClick={()=>{gainStar();play('success');alert('⭐ You earned a star!')}}>Claim Star</button></div>)}</Modal></div>)}
