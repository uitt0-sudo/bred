import React,{useState}from'react'
import {useApp}from'../store'
import {api}from'../api'
export default function Account(){const { user, save, settings, achievements, stars } = useApp();const [form,set]=useState({ name:user?.name||'', avatar:user?.avatar||'/assets/img/logo-bear.png' });if(!user)return <p className='muted'>Please log in to manage your account.</p>;async function saveProfile(){try{const r=await api.update(user.email,{name:form.name,avatar:form.avatar});save({user:r.user});alert('Saved!')}catch(e){alert(e.message)}}return(<div><h2>Account</h2><div className='panel'><div className='row' style={{gap:14}}><img src={user.avatar} style={{width:80,height:80,borderRadius:16}}/><div><div><b>{user.name}</b></div><div className='muted'>{user.email}</div></div></div><div className='form-grid' style={{marginTop:10}}><div><label>Name</label><input className='input' value={form.name} onChange={e=>set({...form,name:e.target.value})}/></div><div><label>Avatar URL</label><input className='input' value={form.avatar} onChange={e=>set({...form,avatar:e.target.value})}/></div></div><div style={{marginTop:10}}><button className='btn' onClick={saveProfile}>Save</button></div></div><div className='panel' style={{marginTop:12}}><h3>Settings</h3><label className='row'><input type='checkbox' checked={settings.sound} onChange={e=>save({settings:{...settings,sound:e.target.checked}})} /> Sound</label><div className='row'><span className='muted small' style={{width:90}}>Volume</span><input type='range' min='0' max='1' step='0.01' className='slider' value={settings.volume} onChange={e=>save({settings:{...settings,volume:parseFloat(e.target.value)}})} /></div><label className='row'><input type='checkbox' checked={settings.motion} onChange={e=>save({settings:{...settings,motion:e.target.checked}})} /> Reduced motion</label><label className='row'><input type='checkbox' checked={settings.tts} onChange={e=>save({settings:{...settings,tts:e.target.checked}})} /> Readâ€‘aloud (TTS)</label></div><div className='panel' style={{marginTop:12}}><h3>Badges & history</h3><div className='muted'>Stars: <b>{stars}</b></div><div className='grid'>{achievements.map(a=>(<div key={a.id} className='panel'><div><b>{a.title}</b></div><div className='small muted'>{new Date(a.at).toLocaleString()}</div></div>))}</div></div></div>)}
