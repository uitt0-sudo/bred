import React,{useState}from'react'
import Modal from'./Modal.jsx'
import {useApp}from'../store'
import {api}from'../api'
export function LoginModal(){const {authOpen,closeAuth,save,showToast,play}=useApp();const open=authOpen==='login';const [form,set]=useState({email:'',password:''});async function go(){try{const r=await api.login(form.email,form.password);save({user:r.user});showToast('Welcome back, '+r.user.name+'!');play('success');closeAuth()}catch(e){alert(e.message)}}return(<Modal open={open} title='Log in' onClose={closeAuth}><input className='input' placeholder='Email' onChange={e=>set({...form,email:e.target.value})}/><div style={{height:8}}/><input className='input' type='password' placeholder='Password' onChange={e=>set({...form,password:e.target.value})}/><div style={{height:10}}/><button className='btn' onClick={go}>Log in</button></Modal>)}
export function SignupModal(){const {authOpen,closeAuth,save,showToast,play}=useApp();const open=authOpen==='signup';const [form,set]=useState({name:'',email:'',password:''});async function go(){if(!form.name||!form.email||!form.password)return alert('Fill all fields');try{await api.signup(form.name,form.email,form.password);const r=await api.login(form.email,form.password);save({user:r.user});showToast('Hi '+form.name+'!');play('success');closeAuth()}catch(e){alert(e.message)}}return(<Modal open={open} title='Join Free' onClose={closeAuth}><input className='input' placeholder='Name' onChange={e=>set({...form,name:e.target.value})}/><div style={{height:8}}/><input className='input' placeholder='Email' onChange={e=>set({...form,email:e.target.value})}/><div style={{height:8}}/><input className='input' type='password' placeholder='Password' onChange={e=>set({...form,password:e.target.value})}/><div style={{height:10}}/><button className='btn' onClick={go}>Create account</button></Modal>)}
